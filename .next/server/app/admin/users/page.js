(()=>{var e={};e.id=674,e.ids=[674],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4322:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>o.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>i}),s(9049),s(3538),s(5866);var t=s(3191),a=s(8716),l=s(7922),o=s.n(l),d=s(5231),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);s.d(r,n);let i=["",{children:["admin",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,9049)),"C:\\Users\\puspa\\OneDrive\\Documents\\Work\\luxylyfe_project\\app\\admin\\users\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,3538)),"C:\\Users\\puspa\\OneDrive\\Documents\\Work\\luxylyfe_project\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\puspa\\OneDrive\\Documents\\Work\\luxylyfe_project\\app\\admin\\users\\page.tsx"],u="/admin/users/page",x={require:s,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/users/page",pathname:"/admin/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:i}})},3412:(e,r,s)=>{Promise.resolve().then(s.bind(s,8256))},8256:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>d});var t=s(326),a=s(7577),l=s(5047),o=s(434);function d(){let[e,r]=(0,a.useState)(null),[s,d]=(0,a.useState)([]),[n,i]=(0,a.useState)(!0),[c,u]=(0,a.useState)(!1),[x,p]=(0,a.useState)(!1),[m,h]=(0,a.useState)(null),[g,b]=(0,a.useState)(""),[y,f]=(0,a.useState)(""),w=(0,l.useRouter)(),[j,N]=(0,a.useState)({name:"",email:"",phone:"",password:"",role:"MEMBER",propertyAddress:"",propertyNumber:""}),[v,P]=(0,a.useState)({userId:"",newPassword:"",confirmPassword:""}),k=async()=>{try{let e=await fetch("/api/admin/users");if(e.ok){let r=await e.json();d(r.users)}else b("Failed to load users")}catch(e){console.error("Failed to load users:",e),b("Failed to load users")}},C=async e=>{e.preventDefault(),u(!0),b(""),f("");try{let e=await fetch("/api/admin/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)}),r=await e.json();e.ok?(f(`User ${j.email} created successfully!`),N({name:"",email:"",phone:"",password:"",role:"MEMBER",propertyAddress:"",propertyNumber:""}),await k()):b(r.error||"Failed to create user")}catch(e){console.error("Create user error:",e),b("Failed to create user")}finally{u(!1)}},E=async e=>{if(e.preventDefault(),p(!0),b(""),f(""),v.newPassword!==v.confirmPassword){b("Passwords do not match"),p(!1);return}if(v.newPassword.length<6){b("Password must be at least 6 characters long"),p(!1);return}try{let e=await fetch("/api/admin/users/password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:v.userId,newPassword:v.newPassword})}),r=await e.json();e.ok?(f("Password updated successfully!"),P({userId:"",newPassword:"",confirmPassword:""}),h(null)):b(r.error||"Failed to update password")}catch(e){console.error("Update password error:",e),b("Failed to update password")}finally{p(!1)}},S=async(e,r)=>{if(confirm(`Are you sure you want to delete user ${r}?`))try{let s=await fetch(`/api/admin/users/${e}`,{method:"DELETE"});if(s.ok)f(`User ${r} deleted successfully!`),await k();else{let e=await s.json();b(e.error||"Failed to delete user")}}catch(e){console.error("Delete user error:",e),b("Failed to delete user")}},U=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),w.push("/")}catch(e){console.error("Logout failed:",e)}};return n?t.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[t.jsx("nav",{className:"bg-white shadow-lg",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4",children:(0,t.jsxs)("div",{className:"flex justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),t.jsx("span",{className:"bg-red-100 text-red-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:"SUPERADMIN"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[t.jsx(o.default,{href:"/admin/dashboard",className:"text-blue-600 hover:text-blue-500",children:"Back to Dashboard"}),(0,t.jsxs)("span",{className:"text-gray-700",children:["Welcome, ",e?.name||e?.email]}),t.jsx("button",{onClick:U,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"Logout"})]})]})})}),(0,t.jsxs)("main",{className:"max-w-7xl mx-auto py-6 px-4",children:[g&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:g}),y&&t.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6",children:y}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Create New User"}),(0,t.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),t.jsx("input",{type:"text",value:j.name,onChange:e=>N({...j,name:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter full name"})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),t.jsx("input",{type:"email",value:j.email,onChange:e=>N({...j,email:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email address"})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),t.jsx("input",{type:"tel",value:j.phone,onChange:e=>N({...j,phone:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter phone number"})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role *"}),(0,t.jsxs)("select",{value:j.role,onChange:e=>N({...j,role:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[t.jsx("option",{value:"MEMBER",children:"Member"}),t.jsx("option",{value:"ADMIN",children:"Admin"}),t.jsx("option",{value:"SUPERADMIN",children:"Super Admin"})]})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password *"}),t.jsx("input",{type:"password",value:j.password,onChange:e=>N({...j,password:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter password (min. 6 characters)"})]}),"MEMBER"===j.role&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Address"}),t.jsx("textarea",{value:j.propertyAddress,onChange:e=>N({...j,propertyAddress:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter property address"})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Number/Unit"}),t.jsx("input",{type:"text",value:j.propertyNumber,onChange:e=>N({...j,propertyNumber:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter property number or unit"})]})]}),t.jsx("button",{type:"submit",disabled:c,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-300 disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Creating User...":"Create User"})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Update User Password"}),(0,t.jsxs)("form",{onSubmit:E,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select User *"}),(0,t.jsxs)("select",{value:v.userId,onChange:e=>{let r=e.target.value;P({...v,userId:r}),h(s.find(e=>e.id===r)||null)},required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[t.jsx("option",{value:"",children:"Choose a user..."}),s.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name||e.email," (",e.role,")"]},e.id))]})]}),m&&(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,t.jsxs)("p",{className:"text-sm text-gray-700",children:[t.jsx("strong",{children:"Selected:"})," ",m.name||m.email]}),(0,t.jsxs)("p",{className:"text-sm text-gray-700",children:[t.jsx("strong",{children:"Role:"})," ",m.role]})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password *"}),t.jsx("input",{type:"password",value:v.newPassword,onChange:e=>P({...v,newPassword:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter new password (min. 6 characters)"})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password *"}),t.jsx("input",{type:"password",value:v.confirmPassword,onChange:e=>P({...v,confirmPassword:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Confirm new password"})]}),t.jsx("button",{type:"submit",disabled:x||!v.userId,className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 focus:ring-4 focus:ring-green-300 disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Updating Password...":"Update Password"})]})]})]}),(0,t.jsxs)("div",{className:"mt-8 bg-white rounded-lg shadow",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsxs)("h2",{className:"text-xl font-bold text-gray-900",children:["All Users (",s.length,")"]})}),t.jsx("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(r=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsxs)("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:r.name||"No name"}),t.jsx("div",{className:"text-sm text-gray-500",children:r.email})]})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${"SUPERADMIN"===r.role?"bg-red-100 text-red-800":"ADMIN"===r.role?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:r.role})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.phone||"No phone"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(r.createdAt).toLocaleDateString()}),(0,t.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[t.jsx("button",{onClick:()=>{P({...v,userId:r.id}),h(r)},className:"text-blue-600 hover:text-blue-900",children:"Reset Password"}),r.id!==e?.id&&t.jsx("button",{onClick:()=>S(r.id,r.email),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},r.id))})]})})]})]})]})}},434:(e,r,s)=>{"use strict";s.d(r,{default:()=>a.a});var t=s(9404),a=s.n(t)},5047:(e,r,s)=>{"use strict";var t=s(7389);s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}})},9049:(e,r,s)=>{"use strict";s.r(r),s.d(r,{$$typeof:()=>o,__esModule:()=>l,default:()=>d});var t=s(8570);let a=(0,t.createProxy)(String.raw`C:\Users\puspa\OneDrive\Documents\Work\luxylyfe_project\app\admin\users\page.tsx`),{__esModule:l,$$typeof:o}=a;a.default;let d=(0,t.createProxy)(String.raw`C:\Users\puspa\OneDrive\Documents\Work\luxylyfe_project\app\admin\users\page.tsx#default`)}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[948,707,861],()=>s(4322));module.exports=t})();
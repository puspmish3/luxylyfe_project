"use strict";(()=>{var e={};e.id=710,e.ids=[710],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},753:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>j,requestAsyncStorage:()=>m,routeModule:()=>y,serverHooks:()=>x,staticGenerationAsyncStorage:()=>f});var n={};r.r(n),r.d(n,{GET:()=>l,POST:()=>g,PUT:()=>v});var o=r(9303),s=r(8716),a=r(3131),i=r(7070),u=r(3493),c=r(1482),d=r.n(c);async function p(e){try{let t=e.cookies.get("auth-token")?.value;if(!t)return null;let r=d().verify(t,process.env.JWT_SECRET),n=await u._.user.findUnique({where:{id:r.userId},select:{id:!0,email:!0,role:!0,name:!0}});if(n?.role!=="ADMIN"&&n?.role!=="SUPERADMIN")return null;return n}catch(e){return null}}async function l(e){try{let{searchParams:t}=new URL(e.url),r=t.get("pageType"),n=t.get("sectionType"),o={isActive:!0};r&&(o.pageType=r),n&&(o.sectionType=n);let s=await u._.pageContent.findMany({where:o,orderBy:[{order:"asc"},{createdAt:"desc"}]});return i.NextResponse.json({content:s,message:"Page content retrieved successfully"})}catch(e){return console.error("Error fetching page content:",e),i.NextResponse.json({error:"Failed to fetch page content"},{status:500})}}async function g(e){try{let t=await p(e);if(!t)return i.NextResponse.json({error:"Unauthorized. Admin access required."},{status:403});let{pageType:r,sectionType:n,title:o,subtitle:s,content:a,images:c,order:d}=await e.json();if(!r||!n)return i.NextResponse.json({error:"Page type and section type are required"},{status:400});let l=await u._.pageContent.create({data:{pageType:r,sectionType:n,title:o||null,subtitle:s||null,content:a||null,images:c||[],order:d||0,createdBy:t.id,updatedBy:t.id}});return i.NextResponse.json({message:"Page content created successfully",content:l},{status:201})}catch(e){return console.error("Error creating page content:",e),i.NextResponse.json({error:"Failed to create page content"},{status:500})}}async function v(e){try{let t=await p(e);if(!t)return i.NextResponse.json({error:"Unauthorized. Admin access required."},{status:403});let{id:r,pageType:n,sectionType:o,title:s,subtitle:a,content:c,images:d,order:l,isActive:g}=await e.json();if(!r)return i.NextResponse.json({error:"Content ID is required"},{status:400});let v=await u._.pageContent.update({where:{id:r},data:{pageType:n||void 0,sectionType:o||void 0,title:void 0!==s?s:void 0,subtitle:void 0!==a?a:void 0,content:void 0!==c?c:void 0,images:void 0!==d?d:void 0,order:void 0!==l?l:void 0,isActive:void 0!==g?g:void 0,updatedBy:t.id}});return i.NextResponse.json({message:"Page content updated successfully",content:v})}catch(e){return console.error("Error updating page content:",e),i.NextResponse.json({error:"Failed to update page content"},{status:500})}}let y=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/admin/content/route",pathname:"/api/admin/content",filename:"route",bundlePath:"app/api/admin/content/route"},resolvedPagePath:"C:\\Users\\puspa\\OneDrive\\Documents\\Work\\luxylyfe_project\\app\\api\\admin\\content\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:f,serverHooks:x}=y,h="/api/admin/content/route";function j(){return(0,a.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:f})}},3493:(e,t,r)=>{r.d(t,{_:()=>o});let n=require("@prisma/client"),o=globalThis.prisma??new n.PrismaClient}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,972,482],()=>r(753));module.exports=n})();
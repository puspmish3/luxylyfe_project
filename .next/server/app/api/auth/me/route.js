"use strict";(()=>{var e={};e.id=788,e.ids=[788],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},8052:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>v,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var s={};t.r(s),t.d(s,{GET:()=>c});var n=t(9303),o=t(8716),i=t(3131),a=t(7070),u=t(3493),p=t(9178);async function c(e){try{let r=e.cookies.get("auth-token")?.value;if(!r)return a.NextResponse.json({error:"No authentication token found"},{status:401});(0,p.WX)(r);let t=await u._.session.findFirst({where:{token:r,expiresAt:{gt:new Date}},include:{user:{select:{id:!0,email:!0,role:!0,name:!0,createdAt:!0}}}});if(!t)return a.NextResponse.json({error:"Invalid or expired session"},{status:401});return a.NextResponse.json({user:t.user,isAuthenticated:!0})}catch(e){return console.error("Session verification error:",e),a.NextResponse.json({error:"Invalid token"},{status:401})}}let d=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/me/route",pathname:"/api/auth/me",filename:"route",bundlePath:"app/api/auth/me/route"},resolvedPagePath:"C:\\Users\\puspa\\OneDrive\\Documents\\Work\\luxylyfe_project\\app\\api\\auth\\me\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:h,serverHooks:m}=d,x="/api/auth/me/route";function v(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},9178:(e,r,t)=>{t.d(r,{Gv:()=>a,RA:()=>u,WX:()=>p,c_:()=>i});var s=t(8691),n=t(1482),o=t.n(n);let i=async e=>{let r=parseInt(process.env.BCRYPT_ROUNDS||"12");return await s.ZP.hash(e,r)},a=async(e,r)=>await s.ZP.compare(e,r),u=e=>{let r=process.env.JWT_SECRET;if(!r)throw Error("JWT_SECRET is not defined");return o().sign(e,r,{expiresIn:"24h"})},p=e=>{let r=process.env.JWT_SECRET;if(!r)throw Error("JWT_SECRET is not defined");return o().verify(e,r)}},3493:(e,r,t)=>{t.d(r,{_:()=>n});let s=require("@prisma/client"),n=globalThis.prisma??new s.PrismaClient}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[948,972,482,691],()=>t(8052));module.exports=s})();